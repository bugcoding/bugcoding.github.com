<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="description" content="keep coding, keep moving..."><meta name="keyword"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>zsh+iTerm2折腾记录</title><link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon"><link href="/styles/site.css" rel="stylesheet"></head><body><header class="container" id="header"><div class="header"><div class="header-left"><div class="avatar"><img src="/images/avatar.jpg"></div><div class="author"><div class="author-name"><a href="/">bugcode's note</a></div><div class="about-me">思绪如风，来去匆匆。</div></div></div><div class="header-right"><ul class="navigation"><li><a href="/archives">Archives</a></li><li><a href="/about">About</a></li></ul></div><div class="about-me-mask"><div class="about-me-wrap"><div class="about-me__header"><div class="avatar"><img src="/images/avatar.jpg"></div></div><ul class="socials"><li class="social-item"><span class="label"><img src="/images/socials/github.svg" alt="https://github.com/bugcoding"></span><a href="https://github.com/bugcoding" target="_blank" title="https://github.com/bugcoding">https://github.com/bugcoding</a></li><li class="social-item"><span class="label"><img src="/images/socials/rss.svg" alt="https://bugcode.net/atom.xml"></span><a href="https://bugcode.net/atom.xml" target="_blank" title="https://bugcode.net/atom.xml">https://bugcode.net/atom.xml</a></li></ul></div></div></div></header><div class="container post"><section class="article"><div class="title">zsh+iTerm2折腾记录</div><span class="date">2016年05月03日</span><span>   </span><span class="tags"></span><div class="content"><p>一直就感觉Mac自带的Terminal很好用，可以开多个Tab，功能也够，自从开始用Hexo倒腾博客之后突然感觉自带Terminal的窗口切换功能不够强大了，然后去Google了一下，然后就发现了iTerm2，之前也在一些其他博客中看到iTerm2的推荐，但是一直没在意，这次果断去<a href="http://iterm2.com/" target="_blank" rel="noopener">官网</a>下载了一个，开源免费。用了一会感觉特别不错，可设置的选项比自带的多好多，而且关联的文章看了下去还有<a href="https://github.com/robbyrussell/oh-my-zsh" target="_blank" rel="noopener">oh-my-zsh</a>这个zsh的配置的框架，还有好看的主题，一番折腾，终端大致变成了这个样子</p>
<a id="more"></a>
<p><img src="/chapimages/my_terminal.png" alt=""></p>
<ul>
<li><p><strong>iTerm2</strong></p>
<p>官网下载，按自己需求设置一下，比如设置隐藏显示的快捷键，设置主题，设置字体，设置字体里需要额外说明一下，如果是使用上面截图的主题agnoster，就需要一个叫做Powerline的打补丁的字体，不然无法正常显示上面右侧那个实体箭头和主题内的一些特殊字符，倒腾过Vim的Powerline或者Airline状态栏应该都知道这个补丁字体，<a href="https://github.com/powerline/fonts" target="_blank" rel="noopener">传送门</a>可以在这里直接下载已经打好补丁的字体，比如Melon for powerline。总之可以设置得合自己心意就好，iTerm2只是个外壳，真正的还得是zsh，二个搭配起来真好用的一塌糊涂。几个常用快捷键：</p>
<blockquote>
<p>多Tab操作  CMD + T</p>
<p>分屏 CMD + D</p>
<p>自定义的显示与隐藏iTerm  CMD + .</p>
<p>看看光标在哪儿 CMD + /</p>
<p>选择Tab  CMD + Tab窗口数字</p>
</blockquote>
<p><em>用Alfred的还有另一个问题，就是Alfred快捷执行终端命令时，如果不是默认的Terminal的需要自己写一下AppleScript来执行自定义的Terminal的逻辑，万能的git早就有对应的repository了，<a href="https://github.com/stuartcryan/custom-iterm-applescripts-for-alfred" target="_blank" rel="noopener">传送门</a>，按ReadMe进行操作就可以，里面甚至还有操作视频和gif，真是贴心！</em></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 最新版本是2.9 终端中输入下面的命令，弹出框允许即可，然后对应的applescript代码就在剪贴板</span></span><br><span class="line">curl --silent 'https://raw.githubusercontent.com/stuartcryan/custom-iterm-applescripts-for-alfred/master/custom_iterm_script_iterm_2.9.applescript' | pbcopy</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>Zsh</strong></p>
<ol>
<li><p>切换zsh为默认shell</p>
<p>Shell的一种，Mac默认的是bash，还有诸如csh，sh，ksh等，Mac默认已经有了zsh，可以cat一下/etc/shells来看一下当前一共有几个可用的shell，还可以通过echo $SHELL的回显来查看当前用的是哪个shell。现在要切换到zsh，输入以下命令：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">chsh -s /bin/zsh</span><br></pre></td></tr></table></figure>
<p>重启终端就可以看到变化了，再次echo $SHELL，应该就是zsh了。</p>
</li>
<li><p>安装oh-my-zsh配置框架</p>
<p>可以通过git直接来clone repository</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 将oh-my-zsh克隆到本地的用户目录下的/.oh-my-zsh</span></span><br><span class="line">git clone git://github.com/robbyrussell/oh-my-zsh.git ~/.oh-my-zsh</span><br><span class="line"><span class="meta">#</span><span class="bash"> 按oh-my-zsh的ReamMe将模板的zshrc拷贝一份到用户目录</span></span><br><span class="line">cp ~/.oh-my-zsh/templates/zshrc.zsh-template ~/.zshrc</span><br></pre></td></tr></table></figure>
<p>也可以使用wget的方式，这样一步到位，不需要自己指定目录，拷贝zshrc了</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">sh -c "$(wget https://raw.githubusercontent.com/robbyrussell/oh-my-zsh/master/tools/install.sh -O -)"</span><br><span class="line"><span class="meta">#</span><span class="bash"> 或者</span></span><br><span class="line">wget https://github.com/robbyrussell/oh-my-zsh/raw/master/tools/install.sh -O - | sh</span><br></pre></td></tr></table></figure>
<p>这步完成，就会在用户目录下看到.zshrc文件和.on-my-zsh目录了。</p>
</li>
<li><p>配置基本的oh-my-zsh信息</p>
<p>第一步当然是设置主题，直接vi ~/.zshrc，定位到ZSH_THEME行，设置ZSH_THEME=”agnoster”，zsh默认目录是不带颜色的，在.zshrc末尾加上</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">export LSCOLORS="exfxcxdxbxexexabagacad"</span><br></pre></td></tr></table></figure>
<p>同时将原bash用的各种alias都移到这里，因为原来的alias是属于bash的，zsh里需要重新alias一下命令。</p>
<p>到这步，如果字体没问题的话，大致的样子就是上文的图示的样子了。</p>
</li>
<li><p>继续自定义主题</p>
<p>默认agnoster主题的目录是显示全路径的，进入的路径越深，后面的就越长，看起来很不爽，对个人来说没啥必要，改一下主题的配置文件，只显示当前目录，并修改一下背景和前景色，定位到~/.oh-my-zsh/themes目录下，编辑器打开agnoster.zsh-theme，找到prompt_dir函数，修改如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">prompt_dir() &#123;</span><br><span class="line">  prompt_segment 6 black  '%c' # 6和black分别是前景和背景色，这里是上图我的配置</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>这时重启iTerm2就可以看到目录不是全路径了，主题颜色也改了。</p>
<p>默认agnoster主题每行的最前面显示的”userName@localhost”的形式，看了一下git上对于agnoster的说明，可选的配置有一项是DEFAULT_USER项(在.zshrc定义DEFAULT_USER项)，可以显示自定义的字符串，但是也不如意，这里自定义一下，同样修改主题内部的函数实现，如果找到DEFAULT_USER项时，不显示其他只显示其对应的字符串，同时设定前景背景，定位到~/.oh-my-zsh/themes目录下，编辑器打开agnoster.zsh-theme，找到prompt_context函数，修改如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">prompt_context() &#123;</span><br><span class="line">  if [ $DEFAULT_USER ]; then</span><br><span class="line">    prompt_segment blue white "%(!.%&#123;%F&#123;yellow&#125;%&#125;.)$DEFAULT_USER" #只显示自己定义的字符串</span><br><span class="line">  fi</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">#</span><span class="bash"> 如果有其他显示需要可以继续在这个函数里<span class="keyword">elif</span>分支继续改写</span></span><br></pre></td></tr></table></figure>
<p>保存修改，重启iTerm2，就可以看到对应的最前面的字符串已经改为在.zshrc里定义的DEFAULT_USER的值了，并且是蓝底白字。</p>
<p>其他想自己自定义的还可继续改写里面的函数进行自定义配置</p>
</li>
<li><p>zsh插件</p>
<p>zsh自带的插件是git且只有这一个，另一个好用的的插件是<a href="https://github.com/zsh-users/zsh-syntax-highlighting" target="_blank" rel="noopener"><em>zsh-syntax-highlighting</em></a>功能是shell当前可用的命令都高亮显示，绿色表示命令可用，橙色表示打错或者命令不可用。安装方法参照git里的ReadMe，进到~/.oh-my-zsh/plugins目录，执行如下：</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone https://github.com/zsh-users/zsh-syntax-highlighting.git $&#123;ZSH_CUSTOM:-~/.oh-my-zsh/custom&#125;/plugins/zsh-syntax-highlighting</span><br></pre></td></tr></table></figure>
<p>完成之后再在~/.zshrc里的plugin行最后填上zsh-syntax-highlighting插件名字</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">plugins=(git zsh-syntax-highlighting)</span><br></pre></td></tr></table></figure>
<p>重启iTerm就可以试着敲命令看效果了。到此终端就与上图完全一致了。</p>
</li>
</ol>
</li>
</ul>
</div></section></div><div class="container"><ul class="nav"><li>上一篇：<a href="/2016/05/05/Hexo多说评论踩坑记录.html">Hexo多说评论踩坑记录</a></li><li>下一篇：<a href="/2016/05/02/SwiftNote-6.html">SwiftNote-6</a></li></ul></div><div id="backToTop"><div class="back-arrow back-arrow-left"></div><div class="back-arrow back-arrow-right"></div></div><footer class="container"><div class="rights"><center class="span">2014-2018 bugcode.</center></div></footer><script src="/script/jquery.min.js"></script><script src="/script/index.js"></script><script src="/script/jquery.min.js"></script><script src="/script/index.js"></script><script src="/script/post.js"></script></body></html>