<!DOCTYPE html><html><head><meta charset="utf-8"><meta name="description" content="keep coding, keep moving..."><meta name="keyword"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta http-equiv="X-UA-Compatible" content="IE=edge"><title>Function Currying</title><link rel="shortcut icon" href="/images/favicon.png" type="image/x-icon"><link href="/styles/site.css" rel="stylesheet"></head><body><header class="container" id="header"><div class="header"><div class="header-left"><div class="avatar"><img src="/images/avatar.jpg"></div><div class="author"><div class="author-name"><a href="/">bugcode's note</a></div><div class="about-me">keep coding, keep moving...</div></div></div><div class="header-right"><ul class="navigation"><li><a href="/archives">Archives</a></li><li><a href="/about">About</a></li></ul></div><div class="about-me-mask"><div class="about-me-wrap"><div class="about-me__header"><div class="avatar"><img src="/images/avatar.jpg"></div></div><ul class="socials"><li class="social-item"><span class="label"><img src="/images/socials/github.svg" alt="https://github.com/bugcoding"></span><a href="https://github.com/bugcoding" target="_blank" title="https://github.com/bugcoding">https://github.com/bugcoding</a></li></ul></div></div></div></header><div class="container post"><section class="article"><div class="title">Function Currying</div><span class="date">2016年06月26日</span><span>   </span><span class="tags"><a class="tag-link" href="/tags/Swift/">Swift</a></span><div class="content"><h3 id="函数柯里化"><a href="#函数柯里化" class="headerlink" title="函数柯里化"></a>函数柯里化</h3><p>前几天Swift发布3.0预览版，改动的还不小，不兼容Swift2.2，加了诸多特性，也去掉了不少语法，看到的第一个就是在Swift3.0里去掉了<strong>Function Currying(函数柯里化)</strong>的语法声明形式，具体可以看<a href="https://github.com/apple/swift-evolution/blob/master/proposals/0002-remove-currying.md" target="_blank" rel="noopener">这里</a>。之前从来没有了解过这个术语，只知道大致的意思，这里记录一下。</p>
<a id="more"></a>
<h3 id="概念"><a href="#概念" class="headerlink" title="概念"></a>概念</h3><p>函数柯里化是计算机科学里的术语，简单的说就是把一个接受<strong>多个参数</strong>的函数转换为接受<strong>一个参数</strong>的函数，并且<strong>返回</strong>一个这样的<strong>函数</strong>，这个函数接受剩下没有处理的参数且把最终结果返回。具体可参照<a href="https://zh.wikipedia.org/wiki/%E6%9F%AF%E9%87%8C%E5%8C%96" target="_blank" rel="noopener">Wiki</a>的解释。</p>
<h3 id="为什么要使用函数柯里化"><a href="#为什么要使用函数柯里化" class="headerlink" title="为什么要使用函数柯里化"></a>为什么要使用函数柯里化</h3><p>函数式编程的思想，把函数变成”一个输入一个输出”的单个小片段，从而可以更好的与其他接口组合出更强大的功能，整个过程也更易理解，看起来就是把一大堆复杂的东西，”一步一步的”构造出来，而这中间的过程都是单一的可组合的，更加灵活的。至于为什么Swift3.0会去掉函数柯里化的语法，<a href="https://github.com/apple/swift-evolution/blob/master/proposals/0002-remove-currying.md" target="_blank" rel="noopener">SE-0002</a>提案给出的解释是在Swift里柯里化的功能有限，且增加了语言实现的复杂度。</p>
<h3 id="Example"><a href="#Example" class="headerlink" title="Example"></a>Example</h3><p>Lua中实现类似的函数柯里化</p>
<figure class="highlight lua"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">currying_test</span><span class="params">(fir)</span></span></span><br><span class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span><span class="params">(sec)</span></span></span><br><span class="line">        <span class="keyword">return</span> <span class="function"><span class="keyword">function</span><span class="params">(thr)</span></span></span><br><span class="line">            <span class="keyword">return</span> fir * sec * thr</span><br><span class="line">        <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(currying_test(<span class="number">2</span>)(<span class="number">3</span>)(<span class="number">4</span>)) <span class="comment">-- 输出24</span></span><br></pre></td></tr></table></figure>
<p>Python中也是类似，不过Python中的functiontools包中还有partial，可以组合出类似的功能。通过固定某些参数的值，组合出更灵活的返回函数完成更多功能。</p>
<p>Swift2.2中的函数柯里化</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">curryingFunction</span><span class="params">(fir:Int)</span></span>(<span class="number">_</span> sec:<span class="type">Int</span>)(<span class="number">_</span> thr:<span class="type">Int</span>) -&gt; <span class="type">Int</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> fir + sec + thr</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">let</span> addSec = curryingFunction(<span class="number">10</span>)</span><br><span class="line"><span class="keyword">let</span> addThr = addSec(<span class="number">11</span>)</span><br><span class="line"><span class="keyword">let</span> res = addThr(<span class="number">12</span>)</span><br><span class="line"><span class="built_in">print</span>(res) <span class="comment">// 输出33</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 也可以直接像上面lua那样直接调用</span></span><br><span class="line"><span class="built_in">print</span>(curryingFunction(<span class="number">10</span>)(<span class="number">11</span>)(<span class="number">12</span>))</span><br></pre></td></tr></table></figure>
<p>可能在实际项目中不会追根究底的去这样儿用，只求达到最终目的，或者是并没有理解到柯里化的真正精髓，但是多知道一些总是好的。</p>
<p><em>End记录</em></p>
</div></section></div><div class="container"><ul class="nav"><li>上一篇：<a href="/2016/06/27/端午节后碎念.html">端午节后碎念</a></li><li>下一篇：<a href="/2016/06/16/好用的shell命令和常用的SVN命令记录.html">好用的shell命令和常用的SVN命令记录</a></li></ul></div><div id="backToTop"><div class="back-arrow back-arrow-left"></div><div class="back-arrow back-arrow-right"></div></div><footer class="container"><div class="rights"><center class="span">2014-2018 bugcode.</center></div></footer><script src="/script/jquery.min.js"></script><link rel="stylesheet" href="/fancybox/jquery.fancybox.css"><script src="/fancybox/jquery.fancybox.pack.js"></script><script src="/script/index.js"></script><script src="/script/jquery.min.js"></script><link rel="stylesheet" href="/fancybox/jquery.fancybox.css"><script src="/fancybox/jquery.fancybox.pack.js"></script><script src="/script/index.js"></script><script src="/script/post.js"></script></body></html>